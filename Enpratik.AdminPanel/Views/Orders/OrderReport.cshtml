@model IEnumerable<Enpratik.Data.Product_BasketItem>
@using Enpratik.Core;
@using Enpratik.Data;
@{
    EnPratik_DataHelper db = new EnPratik_DataHelper();
    ViewBag.Title = "OrderReport";

    var totalOrders = ViewBag.TotalOrders;
    var totalPrices = ViewBag.TotalPrices;
    var totalCustomers = ViewBag.TotalCustomers;
    var orderProducts = ViewBag.OrderProducts as List<Product_BasketItem>;


}

<div class="col-md-12 col-sm-12 col-xs-12">
    <div class="x_panel">
        <div class="x_title">
            <h2>Satış Raporları</h2>
            <ul class="nav navbar-right panel_toolbox">
                <li class="dropdown">
                    <div class="form-group">

                    </div>
                </li>
            </ul>
            <div class="clearfix"></div>
        </div>
        <div class="x_content">

            <div class="form-horizontal form-label-left">
                @using (Html.BeginForm())
                {
                    <div class="form-group">
                        <label class="control-label col-md-2">Sipariş Tarihi (başlangıç)</label>
                        <div class="col-md-4">
                            @Html.TextBox("OrderStartDate", "", new { @class = "form-control", @type = "date" })
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="control-label col-md-2">Sipariş Tarihi (bitiş)</label>
                        <div class="col-md-4">
                            @Html.TextBox("OrderEndDate", "", new { @class = "form-control", @type = "date" })
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="control-label col-md-2"></label>
                        <div class="col-md-4">
                            <button type="submit" class="btn btn-primary">Raporu Getir</button>
                        </div>
                    </div>
                }
            </div>
            <div class="clearfix"></div>


            <hr />
            <h2>Toplam Üye Sayısı</h2>
            <table class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
                <thead>
                    <tr>
                        <th>Üye Sayısı</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>@totalCustomers</td>
                    </tr>
                </tbody>
            </table>


            <hr />
            <h2>
                Toplam Satış Raporu
            </h2>
            <table class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
                <thead>
                    <tr>
                        <th>Toplam Satış Miktarı</th>
                        <th>Toplam Ciro</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>@totalOrders</td>
                        <td>@Enpratik.Core.Functions.MoneyFormat(2, totalPrices) ₺</td>
                    </tr>
                </tbody>
            </table>

            <hr />

            <h2>
                Ürün Satış Raporu
            </h2>
            <table id="tblOrders" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
                <thead>
                    <tr class="table-head">
                        <th class="column-2">Ürün</th>
                        <th class="column-3">Fiyat</th>
                        <th class="column-4 p-l-70">Miktar</th>
                        <th class="column-5">Toplam</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in orderProducts)
                    {

                        var product = item.GetProduct();

                        if (product != null)
                        {

                            <tr class="table-row">
                                <td class="column-2">
                                    @product.ProductName
                                    @{
                                        foreach (var variant in item.getVariantAttributesData())
                                        {
                                            <p style="font-size:11px;">
                                                @variant.variantName : @variant.variantValue
                                            </p>
                                        }
                                    }
                                </td>
                                <td class="column-3">@Enpratik.Core.Functions.MoneyFormat(2, item.Price) ₺</td>
                                <td class="column-4">
                                    @item.Quantity
                                </td>
                                <td class="column-5">@Enpratik.Core.Functions.MoneyFormat(2, item.Price * item.Quantity) ₺</td>
                            </tr>
                        }
                    }
                </tbody>
            </table>

        </div>
    </div>
</div>

